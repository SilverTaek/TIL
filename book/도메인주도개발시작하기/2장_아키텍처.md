# 아키텍처 개요

## 2.1 네 개의 영역

- 표현, 응용, 도메인, 인프라스트럭처는 아키텍처를 설계할 때 출현하는 전형적인 영역
- 표현 영역은 사용자의 요청을 받아 응용 영역에 전달하고, 응용 영역의 처리 결과를 다시 사용자에게 보여주는 역할
- 응용 영역은 기능을 구현하기 위해 도메인 영역의 도메인 모델을 사용
- 핵심 로직은 도메인 영역에서 구현
- 인프라스트럭처 영역은 구현 기술(RDBMS 연동, 메시징 큐 전송수신 등)

## 2.2 계층 구조 아키텍처

- 상위 계층에서 하위 계층으로의 의존만 존재하고 하위 계층은 상위 계층에 의존하지 않는다.
- `응용 계층`은 `도메인 계층`에 의존하지만 외부 시스템과의 연동을 위해 `인프라스트럭처 계층`에 의존하기도 한다.
- 인프라스트럭처에 의존하면 `테스트 어려움` 과 `기능 확장의 어려움` 두 가지 문제가 발생한다.

## 2.3 DIP(Dependency Inversion Principle)

```jsx
첫째, 상위 모듈은 하위 모듈에 의존해서는 안된다. 상위 모듈과 하위 모듈 모두 추상화에 의존해야 한다.
둘째, 추상화는 세부 사항에 의존해서는 안된다. 세부사항이 추상화에 의존해야 한다.
이 원칙은 '상위와 하위 객체 모두가 동일한 추상화에 의존해야 한다'는 객체 지향적 설계의 대원칙을 제공한다

-위키백과-
```

- DIP 는 위의 문제를 해결하기 위해 저수준 모듈이 고수준 모듈에 의존하도록 바꾼다.
- 인프라스트럭처 영역은 구현 기술을 다루는 저수준 모듈이고 응용 영역과 도메인 영역은 고수준 영역

## 2.4 도메인 영역의 주요 구성요소

### 엔티티와 밸류

- 도메인 모델의 엔티티는 데이터와 함께 도메인 기능을 함께 제공한다.
- 밸류는 불변으로 구현할 것 을 권장 엔티티의 밸류 타입 데이터를 변경할 때는 객체 자체를 완전히 교체한다는 의미

### 애그리거트

- 도메인 모델에서 전체 구조를 이해하는 데 도움이 되는 것
- 상위 수준에서 모델을 볼 수 있어야 전체 모델의 관계와 개별 모델을 이해하는데 도움이 된다.
- 애그리거트를 어떻게 구성했냐에 따라 구현이 복잡해지기도 하고, 트랜잭션 범위가 달라지기도 한다.
- 선택한 구현 기술에 따라 애그리거트 구현에 제약이 생기기도 한다.

### 리포지터리

- 애그리거트 단위로 도메인 객체를 저장하고 조회하는 기능을 정의

## 2.5 요청 처리 흐름

- 사용자가 애플리케이션에 기능 실행을 요청하면 처음 받는 영역은 표현 영역이다.

## 2.6 인프라스트럭처 개요

- 인프라스트럭처는 표현 영역, 응용 영역, 도메인 영역을 지원한다.

## 2.7 모듈 구성

- 아키텍처의 각 영역은 별도 패키지에 위치한다.
